<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SMD Assembly Cost Estimation & Quotation Generator</title>
    <style>
        /* ==================== GLOBAL STYLES ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            --text-dark: #1e293b;
            --text-gray: #64748b;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
            padding: 20px;
        }

        /* ==================== HEADER ==================== */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.95;
            font-size: 14px;
        }

        /* ==================== CONTAINER ==================== */
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ==================== TABS ==================== */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 24px;
            background: var(--bg-white);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            color: var(--text-dark);
        }

        .tab-button:hover {
            background: var(--bg-light);
            border-color: var(--primary-color);
        }

        .tab-button.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ==================== CARDS ==================== */
        .card {
            background: var(--bg-white);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-dark);
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        /* ==================== FORM ELEMENTS ==================== */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: var(--bg-white);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-group input[readonly] {
            background: var(--bg-light);
            cursor: not-allowed;
        }

        /* ==================== BUTTONS ==================== */
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-secondary {
            background: var(--text-gray);
            color: white;
        }

        .btn-secondary:hover {
            background: #475569;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        /* ==================== RESULTS DISPLAY ==================== */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .result-item {
            background: var(--bg-light);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }

        .result-item label {
            font-size: 12px;
            color: var(--text-gray);
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .result-item .value {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-dark);
        }

        .result-item.highlight {
            background: linear-gradient(135deg, #e0f2fe, #dbeafe);
            border-left-color: var(--success-color);
        }

        .result-item.highlight .value {
            color: var(--success-color);
        }

        /* ==================== PRINT STYLES ==================== */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .header,
            .tabs,
            .no-print,
            .btn-group,
            .card-title {
                display: none !important;
            }

            .quotation-preview {
                display: block !important;
                box-shadow: none !important;
                border: none !important;
                margin: 0 !important;
                padding: 20mm !important;
            }

            .page-break {
                page-break-after: always;
            }

            @page {
                size: A4;
                margin: 15mm;
            }
        }

        /* ==================== QUOTATION PREVIEW STYLES ==================== */
        .quotation-preview {
            background: white;
            padding: 40px;
            font-family: Arial, sans-serif;
            color: #000;
            max-width: 210mm;
            margin: 0 auto;
        }

        .quotation-header {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #000;
        }

        .company-info h2 {
            font-size: 20px;
            margin-bottom: 5px;
            color: #1e40af;
        }

        .company-info p {
            font-size: 11px;
            line-height: 1.4;
            margin: 2px 0;
        }

        .quotation-title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            text-transform: uppercase;
            color: #1e40af;
        }

        .client-info {
            margin-bottom: 20px;
            background: #f8fafc;
            padding: 15px;
            border-radius: 5px;
        }

        .client-info p {
            font-size: 12px;
            margin: 5px 0;
        }

        .quotation-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 12px;
        }

        .quotation-table th {
            background: #1e40af;
            color: white;
            padding: 10px 8px;
            text-align: left;
            font-weight: 600;
            border: 1px solid #1e40af;
        }

        .quotation-table td {
            padding: 8px;
            border: 1px solid #cbd5e1;
        }

        .quotation-table tr:nth-child(even) {
            background: #f8fafc;
        }

        .quotation-table .text-right {
            text-align: right;
        }

        .quotation-table .text-center {
            text-align: center;
        }

        .quotation-totals {
            margin-top: 20px;
            display: flex;
            justify-content: flex-end;
        }

        .totals-table {
            width: 400px;
        }

        .totals-table tr td {
            padding: 8px;
            border: 1px solid #cbd5e1;
        }

        .totals-table tr td:first-child {
            font-weight: 600;
            background: #f1f5f9;
        }

        .totals-table .grand-total {
            background: #1e40af;
            color: white;
            font-weight: 700;
            font-size: 14px;
        }

        .quotation-footer {
            margin-top: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .terms-conditions {
            font-size: 11px;
        }

        .terms-conditions h4 {
            margin-bottom: 10px;
            color: #1e40af;
        }

        .terms-conditions ul {
            list-style: none;
            padding-left: 0;
        }

        .terms-conditions li {
            margin: 5px 0;
            padding-left: 15px;
            position: relative;
        }

        .terms-conditions li:before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
        }

        .bank-details {
            background: #f8fafc;
            padding: 15px;
            border-radius: 5px;
            font-size: 11px;
        }

        .bank-details h4 {
            margin-bottom: 10px;
            color: #1e40af;
        }

        .bank-details p {
            margin: 3px 0;
        }

        .signatures {
            margin-top: 40px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
        }

        .signature-block {
            text-align: center;
            padding-top: 50px;
            border-top: 1px solid #000;
        }

        .signature-block p {
            font-size: 12px;
            font-weight: 600;
            margin-top: 5px;
        }

        /* ==================== RESPONSIVE DESIGN ==================== */
        @media (max-width: 768px) {
            .quotation-header,
            .quotation-footer,
            .signatures {
                grid-template-columns: 1fr;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .quotation-preview {
                padding: 20px;
            }
        }

        /* ==================== ALERTS ==================== */
        .alert {
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .alert-info {
            background: #dbeafe;
            color: #1e40af;
            border-left: 4px solid var(--primary-color);
        }

        /* ==================== DATABASE INDICATOR ==================== */
        .db-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 12px;
            box-shadow: var(--shadow-lg);
            display: none;
            z-index: 1000;
        }

        .db-status.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>üîß SMD Assembly Cost Estimation & Quotation Generator</h1>
        <p>Professional tool for calculating SMT assembly costs with automated quotation generation</p>
    </div>

    <div class="container">
        <!-- Tab Navigation -->
        <div class="tabs no-print">
            <button class="tab-button active" onclick="switchTab(event, 'calculator')">üí∞ Cost Calculator</button>
            <button class="tab-button" onclick="switchTab(event, 'quotation')">üìÑ Quotation Generator</button>
            <button class="tab-button" onclick="switchTab(event, 'database')">üíæ Database Manager</button>
        </div>

        <!-- TAB 1: COST CALCULATOR -->
        <div id="calculator" class="tab-content active">
            <div class="card">
                <h3 class="card-title">General Cost Parameters</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Rent (Yearly)</label>
                        <input type="number" id="yearlyRent" value="3240000" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>AMC (Yearly)</label>
                        <input type="number" id="yearlyAMC" value="250000" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Manpower (Monthly)</label>
                        <input type="number" id="monthlyManpower" value="88000" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Consumables (Monthly)</label>
                        <input type="number" id="monthlyConsumables" value="20000" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Additional Hour Cost</label>
                        <input type="number" id="additionalHourCost" value="1200" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Monthly Working Days</label>
                        <input type="number" id="workingDays" value="25" onchange="calculateCosts()">
                    </div>
                </div>

                <div class="results-grid">
                    <div class="result-item">
                        <label>Monthly Cost</label>
                        <div class="value" id="monthlyCost">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Per Day Cost</label>
                        <div class="value" id="perDayCost">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Per Hour Cost</label>
                        <div class="value" id="perHourCost">‚Çπ0</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Solder Paste Costing (OM338)</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Per KG Cost (‚Çπ)</label>
                        <input type="number" id="solderPastePerKgCost" value="12300" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Per Panel Consumption (grams)</label>
                        <input type="number" step="0.01" id="perPanelConsumption" value="3" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Boards per Panel</label>
                        <input type="number" id="boardsPerPanel" value="4" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Number of Pads per Board (Top + Bottom)</label>
                        <input type="number" id="padsPerBoard" value="792" onchange="calculateCosts()">
                    </div>
                </div>

                <div class="results-grid">
                    <div class="result-item">
                        <label>Per Gram Cost</label>
                        <div class="value" id="solderPastePerGram">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Per Board Consumption</label>
                        <div class="value" id="perBoardConsumption">0g</div>
                    </div>
                    <div class="result-item">
                        <label>Per Pad Cost</label>
                        <div class="value" id="perPadCost">‚Çπ0</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">PTH (Through-Hole) Costing</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Solder Wire Per KG Cost (‚Çπ)</label>
                        <input type="number" id="solderWirePerKgCost" value="8500" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>PTH Pads per Board</label>
                        <input type="number" id="pthPadsPerBoard" value="26" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Per Board PTH Consumption (grams)</label>
                        <input type="number" step="0.01" id="perBoardPTHConsumption" value="2.5" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Soldering Cost (‚Çπ)</label>
                        <input type="number" id="solderingCost" value="100000" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>PTH Per Pad Cost (‚Çπ)</label>
                        <input type="number" step="0.01" id="pthPerPadCost" value="0.4" onchange="calculateCosts()">
                    </div>
                </div>

                <div class="results-grid">
                    <div class="result-item">
                        <label>Solder Wire Per Gram Cost</label>
                        <div class="value" id="solderWirePerGram">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Per Pad PTH Cost</label>
                        <div class="value" id="perPadPTHCost">‚Çπ0</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Work Order Parameters</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Kit Quantity</label>
                        <input type="number" id="kitQty" value="10000" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Real Time CPH (Components Per Hour)</label>
                        <input type="number" id="realTimeCPH" value="16000" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Placements per Board (Top + Bottom)</label>
                        <input type="number" id="placementsPerBoard" value="268" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Loading Hours</label>
                        <input type="number" step="0.1" id="loadingHours" value="4" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Programming Hours</label>
                        <input type="number" step="0.1" id="programmingHours" value="0" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Additional Hours Forecasted</label>
                        <input type="number" step="0.1" id="additionalHours" value="0" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>Profit Margin (%)</label>
                        <input type="number" step="0.1" id="profitMargin" value="30" onchange="calculateCosts()">
                    </div>
                    <div class="form-group">
                        <label>NRE (Non-Recurring Engineering)</label>
                        <input type="number" id="nreCost" value="0" onchange="calculateCosts()">
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Final Cost Breakdown</h3>
                <div class="results-grid">
                    <div class="result-item">
                        <label>Total Working Hours</label>
                        <div class="value" id="totalHours">0</div>
                    </div>
                    <div class="result-item">
                        <label>Machine Working Cost</label>
                        <div class="value" id="machineWorkingCost">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Total Solder Paste Cost</label>
                        <div class="value" id="totalSolderPasteCost">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Total Solder Wire Cost</label>
                        <div class="value" id="totalSolderWireCost">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Total PTH Cost</label>
                        <div class="value" id="totalPTHCost">‚Çπ0</div>
                    </div>
                    <div class="result-item highlight">
                        <label>Total Cost (Before Margin)</label>
                        <div class="value" id="totalCostBeforeMargin">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Profit Amount</label>
                        <div class="value" id="profitAmount">‚Çπ0</div>
                    </div>
                    <div class="result-item highlight">
                        <label>Final Cost (With Margin)</label>
                        <div class="value" id="finalCost">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Per Board Cost</label>
                        <div class="value" id="perBoardCost">‚Çπ0</div>
                    </div>
                    <div class="result-item highlight">
                        <label>Total with 18% GST</label>
                        <div class="value" id="totalWithGST">‚Çπ0</div>
                    </div>
                    <div class="result-item">
                        <label>Per Board Cost (incl. GST)</label>
                        <div class="value" id="perBoardCostGST">‚Çπ0</div>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="saveCalculation()">üíæ Save Calculation</button>
                    <button class="btn btn-success" onclick="exportToQuotation()">üìÑ Generate Quotation</button>
                    <button class="btn btn-warning" onclick="resetCalculator()">üîÑ Reset</button>
                </div>
            </div>
        </div>

        <!-- TAB 2: QUOTATION GENERATOR -->
        <div id="quotation" class="tab-content">
            <div class="card no-print">
                <h3 class="card-title">Quotation Details</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Company Name</label>
                        <input type="text" id="companyName" value="Transight Systems Pvt Ltd">
                    </div>
                    <div class="form-group">
                        <label>Address Line 1</label>
                        <input type="text" id="addressLine1" value="Kerala Technology Innovation Zone">
                    </div>
                    <div class="form-group">
                        <label>Address Line 2</label>
                        <input type="text" id="addressLine2" value="Kinfra Hi-Tech Park">
                    </div>
                    <div class="form-group">
                        <label>City</label>
                        <input type="text" id="city" value="Cochin">
                    </div>
                    <div class="form-group">
                        <label>State</label>
                        <input type="text" id="state" value="Kerala">
                    </div>
                    <div class="form-group">
                        <label>Pin Code</label>
                        <input type="text" id="pinCode" value="683503">
                    </div>
                    <div class="form-group">
                        <label>GST Number</label>
                        <input type="text" id="gstNumber" value="32AAFCT0250K1ZM">
                    </div>
                    <div class="form-group">
                        <label>Client Name</label>
                        <input type="text" id="clientName" value="Eve Labs">
                    </div>
                    <div class="form-group">
                        <label>Attention To</label>
                        <input type="text" id="attentionTo" value="Karthika">
                    </div>
                    <div class="form-group">
                        <label>Quotation Date</label>
                        <input type="date" id="quotationDate">
                    </div>
                    <div class="form-group">
                        <label>Place</label>
                        <input type="text" id="place" value="Kalamassery">
                    </div>
                    <div class="form-group">
                        <label>Validity (Days)</label>
                        <input type="number" id="validityDays" value="10">
                    </div>
                </div>

                <h3 class="card-title" style="margin-top: 30px;">Product Details</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Type</label>
                        <input type="text" id="productType" value="SMD">
                    </div>
                    <div class="form-group">
                        <label>Model/Product Name</label>
                        <input type="text" id="productModel" value="CALL BUTTON">
                    </div>
                    <div class="form-group">
                        <label>Number of Boards</label>
                        <input type="number" id="numBoards" value="552">
                    </div>
                    <div class="form-group">
                        <label>Per Board Cost (‚Çπ)</label>
                        <input type="number" step="0.01" id="quotationPerBoardCost" value="28">
                    </div>
                    <div class="form-group">
                        <label>NRE Cost (‚Çπ)</label>
                        <input type="number" id="quotationNRE" value="0">
                    </div>
                </div>

                <h3 class="card-title" style="margin-top: 30px;">Bank Details</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Bank Name</label>
                        <input type="text" id="bankName" value="INDIAN BANK, KAKKANAD BR.">
                    </div>
                    <div class="form-group">
                        <label>Account Number</label>
                        <input type="text" id="accountNumber" value="6299115676">
                    </div>
                    <div class="form-group">
                        <label>IFSC Code</label>
                        <input type="text" id="ifscCode" value="IDIB000K176">
                    </div>
                    <div class="form-group">
                        <label>Account Type</label>
                        <input type="text" id="accountType" value="OCC ACCOUNT">
                    </div>
                </div>

                <h3 class="card-title" style="margin-top: 30px;">Authorized Signatories</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Prepared By</label>
                        <input type="text" id="preparedBy" value="Amal P Antony">
                    </div>
                    <div class="form-group">
                        <label>Approved By</label>
                        <input type="text" id="approvedBy" value="Feroz Rehman">
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="generateQuotationPreview()">üîÑ Update Preview</button>
                    <button class="btn btn-success" onclick="window.print()">üñ®Ô∏è Print Quotation</button>
                    <button class="btn btn-warning" onclick="saveQuotation()">üíæ Save to Database</button>
                </div>
            </div>

            <!-- QUOTATION PREVIEW -->
            <div class="quotation-preview" id="quotationPreview">
                <div class="quotation-header">
                    <div class="company-info">
                        <h2 id="preview-companyName">Transight Systems Pvt Ltd</h2>
                        <p id="preview-address"></p>
                        <p><strong>GST:</strong> <span id="preview-gst">32AAFCT0250K1ZM</span></p>
                    </div>
                    <div style="text-align: right;">
                        <p><strong>Date:</strong> <span id="preview-date"></span></p>
                        <p><strong>Place:</strong> <span id="preview-place"></span></p>
                    </div>
                </div>

                <div class="quotation-title">Quotation for SMT Assembling Work</div>

                <div class="client-info">
                    <p><strong>Attention:</strong> <span id="preview-attention"></span></p>
                    <p><strong>Client:</strong> <span id="preview-client"></span></p>
                </div>

                <table class="quotation-table">
                    <thead>
                        <tr>
                            <th>Sl No</th>
                            <th>TYPE</th>
                            <th>MODEL</th>
                            <th class="text-center">No of Boards</th>
                            <th class="text-right">Per Board Cost (‚Çπ)</th>
                            <th class="text-right">Cost of Work (‚Çπ)</th>
                            <th class="text-right">NRE (‚Çπ)</th>
                            <th class="text-right">Total Cost (‚Çπ)</th>
                            <th class="text-right">Total Cost incl. Tax 18% (‚Çπ)</th>
                        </tr>
                    </thead>
                    <tbody id="quotationTableBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>

                <div class="quotation-totals">
                    <table class="totals-table">
                        <tr>
                            <td>TOTAL COST</td>
                            <td class="text-right" id="preview-totalCost">0.00</td>
                        </tr>
                        <tr>
                            <td class="grand-total">ROUNDED TOTAL (‚Çπ)</td>
                            <td class="text-right grand-total" id="preview-roundedTotal">0</td>
                        </tr>
                    </table>
                </div>

                <div class="quotation-footer">
                    <div class="terms-conditions">
                        <h4>Terms and Conditions</h4>
                        <ul>
                            <li>100% payment against delivery</li>
                            <li>Stencil needs to be provided by customer</li>
                            <li>Components and PCB must be in good condition</li>
                            <li>All reels must have part numbers</li>
                            <li>Quote valid for current lot: validity <span id="preview-validity">10</span> days</li>
                        </ul>
                    </div>

                    <div class="bank-details">
                        <h4>Our Bank Details</h4>
                        <p><strong>Bank:</strong> <span id="preview-bankName"></span></p>
                        <p><strong>Account Number:</strong> <span id="preview-accountNumber"></span></p>
                        <p><strong>IFSC:</strong> <span id="preview-ifsc"></span></p>
                        <p><strong>Account Type:</strong> <span id="preview-accountType"></span></p>
                    </div>
                </div>

                <div class="signatures">
                    <div class="signature-block">
                        <p>Prepared By</p>
                        <p id="preview-preparedBy">Amal P Antony</p>
                    </div>
                    <div class="signature-block">
                        <p>Approved By</p>
                        <p id="preview-approvedBy">Feroz Rehman</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 3: DATABASE MANAGER -->
        <div id="database" class="tab-content">
            <div class="card">
                <h3 class="card-title">Database Management</h3>
                <div class="alert alert-info">
                    All calculations and quotations are automatically saved to your browser's local IndexedDB storage. You can export them as JSON files for backup or import previously saved data.
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="exportDatabase()">üì• Export All Data</button>
                    <button class="btn btn-warning" onclick="document.getElementById('importFile').click()">üì§ Import Data</button>
                    <button class="btn btn-secondary" onclick="loadAllRecords()">üîÑ Refresh List</button>
                    <button class="btn btn-danger" onclick="clearDatabase()">üóëÔ∏è Clear All Data</button>
                </div>
                <input type="file" id="importFile" accept=".json" style="display:none" onchange="importDatabase(event)">

                <h3 class="card-title" style="margin-top: 30px;">Saved Calculations</h3>
                <div id="calculationsList"></div>

                <h3 class="card-title" style="margin-top: 30px;">Saved Quotations</h3>
                <div id="quotationsList"></div>
            </div>
        </div>
    </div>

    <!-- Database Status Indicator -->
    <div class="db-status" id="dbStatus">‚úì Data Saved</div>

    <script>
        // ==================== INDEXEDDB SETUP ====================
        let db;
        const DB_NAME = 'SMDCostingDB';
        const DB_VERSION = 1;

        function initDatabase() {
            const request = indexedDB.open(DB_NAME, DB_VERSION);

            request.onerror = () => {
                console.error('Database failed to open');
            };

            request.onsuccess = () => {
                db = request.result;
                console.log('Database opened successfully');
            };

            request.onupgradeneeded = (e) => {
                db = e.target.result;

                if (!db.objectStoreNames.contains('calculations')) {
                    const calcStore = db.createObjectStore('calculations', { keyPath: 'id', autoIncrement: true });
                    calcStore.createIndex('timestamp', 'timestamp', { unique: false });
                }

                if (!db.objectStoreNames.contains('quotations')) {
                    const quotStore = db.createObjectStore('quotations', { keyPath: 'id', autoIncrement: true });
                    quotStore.createIndex('timestamp', 'timestamp', { unique: false });
                }

                console.log('Database setup complete');
            };
        }

        // Save data to IndexedDB
        function saveToDatabase(storeName, data) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const objectStore = transaction.objectStore(storeName);
                data.timestamp = new Date().toISOString();
                const request = objectStore.add(data);

                request.onsuccess = () => {
                    showDBStatus();
                    resolve(request.result);
                };

                request.onerror = () => {
                    reject(request.error);
                };
            });
        }

        // Retrieve all data from store
        function getAllFromDatabase(storeName) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readonly');
                const objectStore = transaction.objectStore(storeName);
                const request = objectStore.getAll();

                request.onsuccess = () => {
                    resolve(request.result);
                };

                request.onerror = () => {
                    reject(request.error);
                };
            });
        }

        // Delete record from database
        function deleteFromDatabase(storeName, id) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([storeName], 'readwrite');
                const objectStore = transaction.objectStore(storeName);
                const request = objectStore.delete(id);

                request.onsuccess = () => {
                    resolve();
                };

                request.onerror = () => {
                    reject(request.error);
                };
            });
        }

        // Show database status indicator
        function showDBStatus() {
            const status = document.getElementById('dbStatus');
            status.classList.add('active');
            setTimeout(() => {
                status.classList.remove('active');
            }, 2000);
        }

        // ==================== COST CALCULATION FUNCTIONS ====================
        function calculateCosts() {
            // General costs
            const yearlyRent = parseFloat(document.getElementById('yearlyRent').value) || 0;
            const yearlyAMC = parseFloat(document.getElementById('yearlyAMC').value) || 0;
            const monthlyManpower = parseFloat(document.getElementById('monthlyManpower').value) || 0;
            const monthlyConsumables = parseFloat(document.getElementById('monthlyConsumables').value) || 0;
            const workingDays = parseFloat(document.getElementById('workingDays').value) || 25;

            const monthlyRent = yearlyRent / 12;
            const monthlyAMC = yearlyAMC / 12;
            const monthlyCost = monthlyRent + monthlyAMC + monthlyManpower + monthlyConsumables;
            const perDayCost = monthlyCost / workingDays;
            const perHourCost = perDayCost / 8; // Assuming 8 hour work day

            document.getElementById('monthlyCost').textContent = '‚Çπ' + monthlyCost.toFixed(2);
            document.getElementById('perDayCost').textContent = '‚Çπ' + perDayCost.toFixed(2);
            document.getElementById('perHourCost').textContent = '‚Çπ' + perHourCost.toFixed(2);

            // Solder Paste Costing
            const solderPastePerKg = parseFloat(document.getElementById('solderPastePerKgCost').value) || 0;
            const perPanelConsumption = parseFloat(document.getElementById('perPanelConsumption').value) || 0;
            const boardsPerPanel = parseFloat(document.getElementById('boardsPerPanel').value) || 1;
            const padsPerBoard = parseFloat(document.getElementById('padsPerBoard').value) || 0;

            const solderPastePerGram = solderPastePerKg / 1000;
            const perBoardConsumption = perPanelConsumption / boardsPerPanel;
            const perPadConsumption = perBoardConsumption / padsPerBoard;
            const perPadCost = perPadConsumption * solderPastePerGram;

            document.getElementById('solderPastePerGram').textContent = '‚Çπ' + solderPastePerGram.toFixed(2);
            document.getElementById('perBoardConsumption').textContent = perBoardConsumption.toFixed(3) + 'g';
            document.getElementById('perPadCost').textContent = '‚Çπ' + perPadCost.toFixed(6);

            // PTH Costing
            const solderWirePerKg = parseFloat(document.getElementById('solderWirePerKgCost').value) || 0;
            const pthPadsPerBoard = parseFloat(document.getElementById('pthPadsPerBoard').value) || 0;
            const perBoardPTHConsumption = parseFloat(document.getElementById('perBoardPTHConsumption').value) || 0;

            const solderWirePerGram = solderWirePerKg / 1000;
            const perPadPTHConsumption = perBoardPTHConsumption / pthPadsPerBoard;
            const perPadPTHCost = perPadPTHConsumption * solderWirePerGram;

            document.getElementById('solderWirePerGram').textContent = '‚Çπ' + solderWirePerGram.toFixed(2);
            document.getElementById('perPadPTHCost').textContent = '‚Çπ' + perPadPTHCost.toFixed(6);

            // Work Order Calculation
            const kitQty = parseFloat(document.getElementById('kitQty').value) || 0;
            const realTimeCPH = parseFloat(document.getElementById('realTimeCPH').value) || 1;
            const placementsPerBoard = parseFloat(document.getElementById('placementsPerBoard').value) || 0;
            const loadingHours = parseFloat(document.getElementById('loadingHours').value) || 0;
            const programmingHours = parseFloat(document.getElementById('programmingHours').value) || 0;
            const additionalHours = parseFloat(document.getElementById('additionalHours').value) || 0;
            const profitMargin = parseFloat(document.getElementById('profitMargin').value) || 0;
            const nreCost = parseFloat(document.getElementById('nreCost').value) || 0;
            const solderingCost = parseFloat(document.getElementById('solderingCost').value) || 0;
            const pthPerPadCost = parseFloat(document.getElementById('pthPerPadCost').value) || 0;

            const totalPlacements = placementsPerBoard * kitQty;
            const placementHours = totalPlacements / realTimeCPH;
            const totalHours = placementHours + loadingHours + programmingHours + additionalHours;

            const machineWorkingCost = totalHours * perHourCost;
            const totalPads = padsPerBoard * kitQty;
            const totalSolderPasteCost = totalPads * perPadCost;
            
            const totalPTHPads = pthPadsPerBoard * kitQty;
            const totalSolderWireCost = totalPTHPads * perPadPTHCost;
            const totalPTHCost = (totalPTHPads * pthPerPadCost) + solderingCost;

            const totalCostBeforeMargin = machineWorkingCost + totalSolderPasteCost + totalSolderWireCost + totalPTHCost;
            const profitAmount = (totalCostBeforeMargin * profitMargin) / 100;
            const finalCost = totalCostBeforeMargin + profitAmount + nreCost;
            const perBoardCost = finalCost / kitQty;
            const totalWithGST = finalCost * 1.18;
            const perBoardCostGST = totalWithGST / kitQty;

            // Display results
            document.getElementById('totalHours').textContent = totalHours.toFixed(2);
            document.getElementById('machineWorkingCost').textContent = '‚Çπ' + machineWorkingCost.toFixed(2);
            document.getElementById('totalSolderPasteCost').textContent = '‚Çπ' + totalSolderPasteCost.toFixed(2);
            document.getElementById('totalSolderWireCost').textContent = '‚Çπ' + totalSolderWireCost.toFixed(2);
            document.getElementById('totalPTHCost').textContent = '‚Çπ' + totalPTHCost.toFixed(2);
            document.getElementById('totalCostBeforeMargin').textContent = '‚Çπ' + totalCostBeforeMargin.toFixed(2);
            document.getElementById('profitAmount').textContent = '‚Çπ' + profitAmount.toFixed(2);
            document.getElementById('finalCost').textContent = '‚Çπ' + finalCost.toFixed(2);
            document.getElementById('perBoardCost').textContent = '‚Çπ' + perBoardCost.toFixed(2);
            document.getElementById('totalWithGST').textContent = '‚Çπ' + totalWithGST.toFixed(2);
            document.getElementById('perBoardCostGST').textContent = '‚Çπ' + perBoardCostGST.toFixed(2);
        }

        // Save calculation to database
        async function saveCalculation() {
            const data = {
                yearlyRent: document.getElementById('yearlyRent').value,
                yearlyAMC: document.getElementById('yearlyAMC').value,
                monthlyManpower: document.getElementById('monthlyManpower').value,
                monthlyConsumables: document.getElementById('monthlyConsumables').value,
                solderPastePerKgCost: document.getElementById('solderPastePerKgCost').value,
                kitQty: document.getElementById('kitQty').value,
                profitMargin: document.getElementById('profitMargin').value,
                finalCost: document.getElementById('finalCost').textContent,
                totalWithGST: document.getElementById('totalWithGST').textContent,
                perBoardCost: document.getElementById('perBoardCost').textContent
            };

            try {
                await saveToDatabase('calculations', data);
                alert('Calculation saved successfully!');
            } catch (error) {
                alert('Error saving calculation: ' + error);
            }
        }

        // Export calculation to quotation
        function exportToQuotation() {
            const perBoardCost = parseFloat(document.getElementById('perBoardCost').textContent.replace('‚Çπ', ''));
            const kitQty = document.getElementById('kitQty').value;
            
            document.getElementById('quotationPerBoardCost').value = perBoardCost.toFixed(2);
            document.getElementById('numBoards').value = kitQty;
            
            // Programmatically switch to quotation tab
            const quotationTab = document.querySelector('.tab-button:nth-child(2)');
            const event = new Event('click');
            switchTab(event, 'quotation');
            quotationTab.classList.add('active');
            document.querySelectorAll('.tab-button').forEach(btn => {
                if (btn !== quotationTab) btn.classList.remove('active');
            });
            
            generateQuotationPreview();
        }

        // Reset calculator
        function resetCalculator() {
            if (confirm('Are you sure you want to reset all values to default?')) {
                document.getElementById('yearlyRent').value = '3240000';
                document.getElementById('yearlyAMC').value = '250000';
                document.getElementById('monthlyManpower').value = '88000';
                document.getElementById('monthlyConsumables').value = '20000';
                document.getElementById('additionalHourCost').value = '1200';
                document.getElementById('workingDays').value = '25';
                document.getElementById('solderPastePerKgCost').value = '12300';
                document.getElementById('perPanelConsumption').value = '3';
                document.getElementById('boardsPerPanel').value = '4';
                document.getElementById('padsPerBoard').value = '792';
                document.getElementById('solderWirePerKgCost').value = '8500';
                document.getElementById('pthPadsPerBoard').value = '26';
                document.getElementById('perBoardPTHConsumption').value = '2.5';
                document.getElementById('solderingCost').value = '100000';
                document.getElementById('pthPerPadCost').value = '0.4';
                document.getElementById('kitQty').value = '10000';
                document.getElementById('realTimeCPH').value = '16000';
                document.getElementById('placementsPerBoard').value = '268';
                document.getElementById('loadingHours').value = '4';
                document.getElementById('programmingHours').value = '0';
                document.getElementById('additionalHours').value = '0';
                document.getElementById('profitMargin').value = '30';
                document.getElementById('nreCost').value = '0';
                calculateCosts();
            }
        }

        // ==================== QUOTATION FUNCTIONS ====================
        function generateQuotationPreview() {
            // Get form values
            const companyName = document.getElementById('companyName').value;
            const addressLine1 = document.getElementById('addressLine1').value;
            const addressLine2 = document.getElementById('addressLine2').value;
            const city = document.getElementById('city').value;
            const state = document.getElementById('state').value;
            const pinCode = document.getElementById('pinCode').value;
            const gstNumber = document.getElementById('gstNumber').value;
            const clientName = document.getElementById('clientName').value;
            const attentionTo = document.getElementById('attentionTo').value;
            const quotationDate = document.getElementById('quotationDate').value;
            const place = document.getElementById('place').value;
            const validityDays = document.getElementById('validityDays').value;

            const productType = document.getElementById('productType').value;
            const productModel = document.getElementById('productModel').value;
            const numBoards = parseFloat(document.getElementById('numBoards').value) || 0;
            const perBoardCost = parseFloat(document.getElementById('quotationPerBoardCost').value) || 0;
            const nreCost = parseFloat(document.getElementById('quotationNRE').value) || 0;

            const bankName = document.getElementById('bankName').value;
            const accountNumber = document.getElementById('accountNumber').value;
            const ifscCode = document.getElementById('ifscCode').value;
            const accountType = document.getElementById('accountType').value;

            const preparedBy = document.getElementById('preparedBy').value;
            const approvedBy = document.getElementById('approvedBy').value;

            // Update preview
            document.getElementById('preview-companyName').textContent = companyName;
            document.getElementById('preview-address').innerHTML = 
                addressLine1 + '<br>' + addressLine2 + '<br>' + city + ', ' + state + ' - ' + pinCode;
            document.getElementById('preview-gst').textContent = gstNumber;
            document.getElementById('preview-date').textContent = quotationDate || new Date().toLocaleDateString('en-GB');
            document.getElementById('preview-place').textContent = place;
            document.getElementById('preview-attention').textContent = attentionTo;
            document.getElementById('preview-client').textContent = clientName;
            document.getElementById('preview-validity').textContent = validityDays;
            document.getElementById('preview-bankName').textContent = bankName;
            document.getElementById('preview-accountNumber').textContent = accountNumber;
            document.getElementById('preview-ifsc').textContent = ifscCode;
            document.getElementById('preview-accountType').textContent = accountType;
            document.getElementById('preview-preparedBy').textContent = preparedBy;
            document.getElementById('preview-approvedBy').textContent = approvedBy;

            // Calculate costs
            const costOfWork = numBoards * perBoardCost;
            const totalCost = costOfWork + nreCost;
            const totalCostWithTax = totalCost * 1.18;
            const roundedTotal = Math.round(totalCostWithTax);

            // Update table
            const tableBody = document.getElementById('quotationTableBody');
            tableBody.innerHTML = `
                <tr>
                    <td>1</td>
                    <td>${productType}</td>
                    <td>${productModel}</td>
                    <td class="text-center">${numBoards}</td>
                    <td class="text-right">${perBoardCost.toFixed(2)}</td>
                    <td class="text-right">${costOfWork.toFixed(2)}</td>
                    <td class="text-right">${nreCost.toFixed(2)}</td>
                    <td class="text-right">${totalCost.toFixed(2)}</td>
                    <td class="text-right">${totalCostWithTax.toFixed(2)}</td>
                </tr>
            `;

            document.getElementById('preview-totalCost').textContent = totalCostWithTax.toFixed(2);
            document.getElementById('preview-roundedTotal').textContent = roundedTotal;
        }

        // Save quotation to database
        async function saveQuotation() {
            const data = {
                companyName: document.getElementById('companyName').value,
                clientName: document.getElementById('clientName').value,
                productModel: document.getElementById('productModel').value,
                numBoards: document.getElementById('numBoards').value,
                perBoardCost: document.getElementById('quotationPerBoardCost').value,
                quotationDate: document.getElementById('quotationDate').value,
                totalCost: document.getElementById('preview-roundedTotal').textContent
            };

            try {
                await saveToDatabase('quotations', data);
                alert('Quotation saved successfully!');
            } catch (error) {
                alert('Error saving quotation: ' + error);
            }
        }

        // ==================== DATABASE MANAGEMENT FUNCTIONS ====================
        async function loadAllRecords() {
            try {
                const calculations = await getAllFromDatabase('calculations');
                const quotations = await getAllFromDatabase('quotations');

                displayCalculations(calculations);
                displayQuotations(quotations);
            } catch (error) {
                console.error('Error loading records:', error);
            }
        }

        function displayCalculations(calculations) {
            const container = document.getElementById('calculationsList');
            
            if (calculations.length === 0) {
                container.innerHTML = '<p style="color: var(--text-gray); text-align: center; padding: 20px;">No saved calculations found.</p>';
                return;
            }

            let html = '<div style="display: grid; gap: 15px;">';
            
            calculations.reverse().forEach(calc => {
                html += `
                    <div class="card" style="margin: 0;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div>
                                <p><strong>Kit Qty:</strong> ${calc.kitQty}</p>
                                <p><strong>Final Cost:</strong> ${calc.finalCost}</p>
                                <p><strong>Total with GST:</strong> ${calc.totalWithGST}</p>
                                <p style="font-size: 11px; color: var(--text-gray);">Saved: ${new Date(calc.timestamp).toLocaleString()}</p>
                            </div>
                            <button class="btn btn-danger" onclick="deleteCalculation(${calc.id})">Delete</button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        function displayQuotations(quotations) {
            const container = document.getElementById('quotationsList');
            
            if (quotations.length === 0) {
                container.innerHTML = '<p style="color: var(--text-gray); text-align: center; padding: 20px;">No saved quotations found.</p>';
                return;
            }

            let html = '<div style="display: grid; gap: 15px;">';
            
            quotations.reverse().forEach(quot => {
                html += `
                    <div class="card" style="margin: 0;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div>
                                <p><strong>Client:</strong> ${quot.clientName}</p>
                                <p><strong>Product:</strong> ${quot.productModel}</p>
                                <p><strong>Boards:</strong> ${quot.numBoards}</p>
                                <p><strong>Total:</strong> ‚Çπ${quot.totalCost}</p>
                                <p style="font-size: 11px; color: var(--text-gray);">Saved: ${new Date(quot.timestamp).toLocaleString()}</p>
                            </div>
                            <button class="btn btn-danger" onclick="deleteQuotation(${quot.id})">Delete</button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        async function deleteCalculation(id) {
            if (confirm('Are you sure you want to delete this calculation?')) {
                try {
                    await deleteFromDatabase('calculations', id);
                    loadAllRecords();
                } catch (error) {
                    alert('Error deleting calculation: ' + error);
                }
            }
        }

        async function deleteQuotation(id) {
            if (confirm('Are you sure you want to delete this quotation?')) {
                try {
                    await deleteFromDatabase('quotations', id);
                    loadAllRecords();
                } catch (error) {
                    alert('Error deleting quotation: ' + error);
                }
            }
        }

        async function exportDatabase() {
            try {
                const calculations = await getAllFromDatabase('calculations');
                const quotations = await getAllFromDatabase('quotations');

                const data = {
                    calculations,
                    quotations,
                    exportDate: new Date().toISOString(),
                    version: DB_VERSION
                };

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `smd_costing_backup_${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
            } catch (error) {
                alert('Error exporting database: ' + error);
            }
        }

        function importDatabase(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = async (e) => {
                try {
                    const data = JSON.parse(e.target.result);

                    if (confirm('This will add imported data to your existing database. Continue?')) {
                        // Import calculations
                        if (data.calculations && Array.isArray(data.calculations)) {
                            for (const calc of data.calculations) {
                                delete calc.id; // Remove ID to create new entries
                                await saveToDatabase('calculations', calc);
                            }
                        }

                        // Import quotations
                        if (data.quotations && Array.isArray(data.quotations)) {
                            for (const quot of data.quotations) {
                                delete quot.id;
                                await saveToDatabase('quotations', quot);
                            }
                        }

                        alert('Data imported successfully!');
                        loadAllRecords();
                    }
                } catch (error) {
                    alert('Error importing data: ' + error);
                }
            };
            reader.readAsText(file);
        }

        function clearDatabase() {
            if (confirm('Are you sure you want to delete ALL saved data? This action cannot be undone!')) {
                if (confirm('This will permanently delete all calculations and quotations. Are you absolutely sure?')) {
                    const transaction = db.transaction(['calculations', 'quotations'], 'readwrite');
                    transaction.objectStore('calculations').clear();
                    transaction.objectStore('quotations').clear();
                    
                    transaction.oncomplete = () => {
                        alert('All data has been cleared.');
                        loadAllRecords();
                    };
                }
            }
        }

        // ==================== TAB SWITCHING ====================
        function switchTab(event, tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked button
            if (event && event.target) {
                event.target.classList.add('active');
            }

            // Load data if switching to database tab
            if (tabName === 'database') {
                loadAllRecords();
            }
        }

        // ==================== INITIALIZATION ====================
        window.addEventListener('DOMContentLoaded', () => {
            initDatabase();
            
            // Set today's date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('quotationDate').value = today;
            
            // Initial calculations
            calculateCosts();
            generateQuotationPreview();
        });
    </script>
</body>
</html>
